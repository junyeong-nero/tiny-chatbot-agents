# 작업 로그 (2026-02-01)

## 📝 요약
오늘 작업은 RAG 파이프라인의 고도화된 로직(Mid/Low 밴드)을 문서화하고, 평가(Evaluation) 시스템의 설정 관리 체계를 구축하며, 보안 및 엣지 케이스를 포함한 데이터셋을 대폭 확충하는 데 집중되었습니다. 또한 MCP 서버를 통한 외부 클라이언트 연동 기반을 마련했습니다.

## 🚀 주요 변경 사항

### 1. RAG 파이프라인 문서화 및 로직 정교화
- **임계값(Threshold) 업데이트**: QnA(0.80), ToS(0.65)로 기본값 조정 및 문서 반영.
- **다단계 응답 로직 도입**:
    - **High-band**: 확정적 답변 제공.
    - **Mid-band (Limited Answer)**: 부분 매칭 시 불확실성을 명시한 제한적 답변.
    - **Low-band (Clarification)**: 정보 부족 시 추가 질문을 통한 명확화.
- **아키텍처 다이어그램 업데이트**: 상세화된 흐름도(Mermaid)를 `docs/rag_architecture.md`에 반영.

### 2. 평가(Evaluation) 프레임워크 고도화
- **YAML 기반 설정 관리**: `configs/evaluation_config.yaml`을 도입하여 모델, 임계값, 재시도 횟수 등을 중앙 관리.
- **차세대 모델 지원**: GPT-5, Claude 4, Gemini 3 등 차세대 모델을 평가 및 저지(Judge) 모델로 설정 가능하도록 업데이트.
- **모델 다양성(Diversity) 강화**: 평가 결과의 편향을 방지하기 위해 생성 모델과 평가 모델을 다르게 매칭하는 `diversity_pairs` 로직 강화.

### 3. 데이터셋 확충 및 보안 강화
- **평가 데이터셋 확장**: `evaluation_dataset.json`에 30개 이상의 신규 케이스 추가.
    - **보안(Attack)**: 프롬프트 인젝션, 탈옥(Jailbreak), 정보 유출 시도 테스트.
    - **도메인 외(OOD)**: 타사 문의, 투자 조언 요청 등 도메인 밖 질문 처리.
    - **엣지 케이스**: 매우 긴 입력, 특수문자/이모지 혼합 질문 등.
- **골든셋 생성 스크립트**: 약관 및 보안 테스트를 위한 정답 생성 자동화 스크립트 추가.

### 4. 시스템 통합 및 환경 설정
- **MCP(Model Context Protocol) 서버**: Claude Desktop 등과 연동을 위한 `src/mcp/server.py` 초기 구현 추가.
- **환경 관리**: 평가 결과 데이터(`data/evaluation/results/`)가 커밋되지 않도록 `.gitignore` 설정 강화.

## 🔗 관련 커밋
- `7b135db`: chore(evaluation): update judge models and ignore results directory
- `f2619a2`: docs: update RAG pipeline documentation to reflect code changes
- `aae4bc8`: feat(mcp): add initial MCP server implementation and versioned dataset
- `498cbed`: feat(evaluation): implement YAML-based configuration and expand evaluation dataset
- `19229b2`: feat(evaluation): finalize evaluation framework and documentation
